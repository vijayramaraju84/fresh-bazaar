<!-- src/app/features/cart/cart.component.html -->
<div class="cart-container" *ngIf="!loading && cartItems.length > 0; else emptyOrLoading">
  <h2>Your Cart</h2>

  <div class="cart-items">
    <div class="cart-item" *ngFor="let item of cartItems">
      <div class="item-details">
        <h3>{{ item.productName }}</h3>
        <p>Price: ₹{{ item.productPrice | number:'1.2-2' }}</p>

        <mat-form-field appearance="fill" class="quantity-input">
          <mat-label>Quantity</mat-label>
          <input
            matInput
            type="number"
            min="1"
            [(ngModel)]="item.quantity"
            (ngModelChange)="updateQuantity(item)"
            [attr.aria-label]="'Quantity for ' + item.productName"
          />
        </mat-form-field>
      </div>

      <div class="item-total">
        <p>Total: ₹{{ (item.productPrice * item.quantity) | number:'1.2-2' }}</p>
        <button
          mat-icon-button
          color="warn"
          (click)="removeItem(item.productId)"
          [attr.aria-label]="'Remove ' + item.productName + ' from cart'"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="cart-summary">
    <h3>Grand Total: ₹{{ totalPrice | number:'1.2-2' }}</h3>
    <button
      mat-raised-button
      color="accent"
      (click)="proceedToCheckout()"
      [disabled]="loading"
    >
      {{ loading ? 'Processing...' : 'Proceed to Checkout' }}
    </button>
  </div>
</div>

<ng-template #emptyOrLoading>
  <div class="empty-cart" *ngIf="!loading; else loadingState">
    <mat-icon class="empty-icon">shopping_cart</mat-icon>
    <h2>Your Cart is Empty</h2>
    <p>Add some products to get started!</p>
    <button mat-raised-button color="primary" routerLink="/products">
      Continue Shopping
    </button>
  </div>
  <ng-template #loadingState>
    <div class="loading-cart">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Loading your cart...</p>
    </div>
  </ng-template>
</ng-template>